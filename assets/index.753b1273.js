import{d as A,K as O,r as g,n as T,L as N,M as C,N as k,G as e,b as V,O as X,P,H as Z,x as G,D as ee,Q as o,R as a,S as R,U as E,c as y,E as te}from"./runtime.7b5c4d8b.js";import{C as j,p as $,a as z,b as U,L as D,P as ae,c as ne,d as H,u as K,S as oe,g as Q,e as se,f as le,h as re,N as M,i as ie,j as ce,k as ue,l as F,m as S,n as W,o as q,q as B,r as de,s as pe,t as fe,v as I,w as me,x as ve,y as he,z as _e,W as ge}from"./ui.97daa107.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();const be=A({__name:"LatentSpace",emits:["hover","step","reset","done"],async setup(m,{emit:s}){let t,l;j.register($,z,U,D,ae,ne,H);const r=([t,l]=O(()=>fetch("/wavetables.json").then(f=>f.json())),t=await t,l(),t).map(([,[f,i]])=>({x:f,y:i})),c=K(),p=g(null),u=f=>{var d,h,b;const i=(d=p.value)==null?void 0:d.chart;if(!i)return;const{x:_,y:x}=Q(f,i),w={x:(h=i.scales.x.getValueForPixel(_))!=null?h:0,y:(b=i.scales.y.getValueForPixel(x))!=null?b:0};s("hover",w),v.value&&s("step",w)},v=g(!1);return T(()=>{v.value?s("reset"):s("done")}),(f,i)=>(N(),C(e(oe),{ref_key:"elementRef",ref:p,"chart-id":"latent-space",onMousemove:k(u,["prevent"]),onMousedown:i[0]||(i[0]=k(_=>v.value=!0,["prevent"])),onMouseup:i[1]||(i[1]=k(_=>v.value=!1,["prevent"])),"chart-data":{datasets:[{label:"Wavetables",backgroundColor:e(c).textColor1,borderColor:e(c).textColor1,data:e(r)}]},"chart-options":{aspectRatio:1,maintainAspectRatio:!0,responsive:!0,elements:{point:{pointStyle:"crossRot"}},plugins:{tooltip:{enabled:!1}}}},null,8,["onMousemove","chart-data"]))}}),Y=A({__name:"LineChart",props:{id:null,aspectRatio:null,points:null,label:null,animation:{type:Boolean,default:!1}},emits:["hover"],setup(m,{emit:s}){const t=m,l=K(),n=V(()=>new Array(t.points.length).fill(0).map((p,u)=>u));j.register($,z,U,D,H);const r=g(),c=p=>{var _,x,w;const u=(_=r.value)==null?void 0:_.chart;if(!u)return;const{x:v,y:f}=Q(p,u),i={x:(x=u.scales.x.getValueForPixel(v))!=null?x:0,y:(w=u.scales.y.getValueForPixel(f))!=null?w:0};s("hover",i)};return(p,u)=>(N(),C(e(se),{ref_key:"chart",ref:r,"chart-id":t.id,onMouseover:k(c,["prevent"]),"chart-options":{animation:t.animation?void 0:!1,aspectRatio:t.aspectRatio,responsive:!0,maintainAspectRatio:!0,elements:{point:{radius:0}},plugins:{decimation:{enabled:!0},tooltip:{enabled:!1}}},"chart-data":{labels:e(n),datasets:[{label:t.label,data:t.points,backgroundColor:e(l).textColor1,borderColor:e(l).textColor1}]}},null,8,["chart-id","onMouseover","chart-options","chart-data"]))}}),ye=A({__name:"ModelInference",props:{pos:null},emits:["run"],async setup(m,{expose:s,emit:t}){let l,n;const r=m,c=([l,n]=O(()=>P.exports.InferenceSession.create("/latentwt.onnx")),l=await l,n(),l),p=g(new Array(256).fill(0));T(()=>p.value?t("run",p.value):void 0);const u=async v=>{const{wavetable:{data:f}}=await c.run({pos:new P.exports.Tensor("float32",[v.x,v.y])});return Array.from(f)};return s({run:u}),X(async()=>{p.value=await u(r.pos)}),(v,f)=>(N(),C(Y,{id:"inference-chart",label:"Wavetable","aspect-ratio":2,points:p.value},null,8,["points"]))}});function we(m,s){const t=document.createElement("a");t.setAttribute("href",URL.createObjectURL(s)),t.setAttribute("download",m),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function xe(m){const s=Z(m);return Object.assign(s,{update:l=>{s.value=le(s.value,l)}})}function Ne(m){const s=window.matchMedia(m),t=g(s.matches),l=n=>t.value=n.matches;return G(()=>{s.addEventListener("change",l)}),ee(()=>s.removeEventListener("change",l)),t}const Ce=y("This webpage runs an AI model in the background that automatically generated waveforms anywhere in this latent space."),ke=R("br",null,null,-1),Ae=y(" You can explore this latent space by hovering your mouse over it, and you can generate and save custom wavetable sequences by clicking and dragging over the latent space."),Le=R("br",null,null,-1),Me=y(" The original wavetables come from "),Se=y("WaveEdit Online"),Re=y(" . "),Pe=y(".wav"),Ee=y("Clear "),Fe=y(" Download "),We=A({__name:"App",setup(m){const s=g({x:0,y:0}),t=xe([]),l=g("wavetable"),n=g(),r=Ne("(prefers-color-scheme: dark)"),c=g(0),p=V(()=>r.value?_e:null),u=re(["message"]),v=d=>{s.value=d},f=d=>{const h=Math.min(...d),L=Math.max(...d)-h;return d.map(J=>2*(J-h)/L-1)},i=async d=>{var b;c.value++;const h=await((b=n.value)==null?void 0:b.run(d));t.update(L=>{L.push(...f(h))}),c.value--},_=()=>{t.value=[]},x=async()=>{if(t.value.length===0)return;if(c.value>0){await G();return}const d=new ge;d.fromScratch(1,44100,"32f",t.value),we(`${l.value}.wav`,new Blob([d.toBuffer().buffer],{type:"audio/x-wav"})),u.message.success("Wavetable sequence generated.")},w=()=>{l.value.length===0&&(l.value="wavetable")};return(d,h)=>(N(),C(e(he),{theme:e(p),"theme-overrides":{common:{fontFamily:"Azaret Mono, monospace",fontFamilyMono:"Azaret Mono, monospace"}}},{default:o(()=>[a(e(me),{title:"Latent Wavetable",subtitle:"AI-generated wavetable sequences",style:{margin:"1rem 4rem"}},{default:o(()=>[a(e(M),{vertical:"","wrap-item":!0},{default:o(()=>[R("div",null,[a(e(ie),null,{default:o(()=>[Ce,ke,Ae,Le,Me,a(e(ce),{href:"https://waveeditonline.com/"},{default:o(()=>[Se]),_:1}),Re]),_:1})]),a(e(ue),{style:{"margin-top":"2rem","flex-grow":"1"},"x-gap":"12",cols:2,"item-responsive":!0},{default:o(()=>[a(e(F),null,{default:o(()=>[a(e(S),{title:"Latent space"},{default:o(()=>[(N(),C(E,null,{fallback:o(()=>[a(e(W),{show:!0},{default:o(()=>[a(e(q))]),_:1})]),default:o(()=>[a(e(B),{appear:!0},{default:o(()=>[a(be,{onReset:_,onHover:v,onStep:i,label:"Wavetables"})]),_:1})]),_:1}))]),_:1})]),_:1}),a(e(F),null,{default:o(()=>[a(e(M),{vertical:""},{default:o(()=>[a(e(S),null,{default:o(()=>[(N(),C(E,null,{fallback:o(()=>[a(e(W),{show:!0},{default:o(()=>[a(e(q),{width:"400px",height:"200px"})]),_:1})]),default:o(()=>[a(e(B),{appear:!0},{default:o(()=>[a(ye,{ref_key:"model",ref:n,pos:s.value},null,8,["pos"])]),_:1})]),_:1}))]),_:1}),a(e(S),null,{action:o(()=>[a(e(M),{justify:"end",size:"small"},{default:o(()=>[a(e(de),null,{default:o(()=>[a(e(pe),{placeholder:"Filename",value:l.value,"onUpdate:value":h[0]||(h[0]=b=>l.value=b),onBlur:w},null,8,["value"]),a(e(fe),null,{default:o(()=>[Pe]),_:1})]),_:1}),a(e(I),{strong:"",secondary:"",onClick:_,disabled:e(t).length===0},{default:o(()=>[Ee]),_:1},8,["disabled"]),a(e(I),{type:"primary",onClick:x,disabled:e(t).length===0},{default:o(()=>[Fe]),_:1},8,["disabled"])]),_:1})]),default:o(()=>[a(Y,{id:"sequence",label:"Generated sequence",points:e(t),"aspect-ratio":2},null,8,["points"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(e(ve))]),_:1},8,["theme"]))}});te(We).mount("#app");
